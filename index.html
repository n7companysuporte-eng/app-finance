<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Finance SaaS</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://unpkg.com/lucide@latest"></script>
<script src="https://unpkg.com/gsap@3/dist/gsap.min.js"></script>
</head>

<body class="bg-gradient-to-br from-green-600 to-yellow-400 min-h-screen flex justify-center">

<div class="w-full max-w-md p-4 text-white">

<h1 class="text-xl font-bold text-center mb-4">Finance SaaS</h1>

<!-- SALDO -->
<div class="bg-white text-black rounded-2xl p-5 shadow-xl mb-4">
<p class="text-sm text-gray-500">Saldo disponÃ­vel no mÃªs</p>
<h2 id="balance" class="text-3xl font-bold text-green-600">R$ 0,00</h2>

<div class="flex gap-3 mt-4">
<button onclick="openModal('income')" class="flex-1 bg-green-600 py-4 rounded-xl text-lg active:scale-95 transition">
+ Receita
</button>
<button onclick="openModal('expense')" class="flex-1 bg-red-500 py-4 rounded-xl text-lg active:scale-95 transition">
- Gasto
</button>
</div>

<p id="message" class="mt-3 text-center font-medium"></p>
</div>

<!-- LIMITE DE GASTOS -->
<div class="bg-white text-black rounded-2xl p-4 shadow mb-4">
<p class="font-semibold mb-2">Limite de Gastos Mensais</p>

<input id="limitInput" type="number" placeholder="Defina seu limite mensal"
class="w-full border rounded-xl p-3 mb-3">

<button onclick="saveLimit()" class="w-full bg-green-600 text-white py-3 rounded-xl active:scale-95 transition">
Salvar limite
</button>

<div class="mt-4">
<div class="flex justify-between text-sm mb-1">
<span>Uso do limite</span>
<span id="limitPercent">0%</span>
</div>

<div class="w-full bg-gray-200 rounded-full h-4">
<div id="limitBar" class="h-4 rounded-full bg-green-500 transition-all"></div>
</div>

<p id="limitStatus" class="text-center font-semibold mt-2"></p>
</div>
</div>

<!-- LANÃ‡AMENTOS -->
<div class="bg-white text-black rounded-2xl p-4 shadow mb-4">
<p class="font-semibold mb-2">LanÃ§amentos</p>
<ul id="list" class="space-y-2 text-sm"></ul>
</div>

<!-- GRÃFICO -->
<div class="bg-white text-black rounded-2xl p-4 shadow">
<p class="font-semibold mb-2">Despesas por categoria</p>
<canvas id="chart"></canvas>
</div>

</div>

<!-- MODAL -->
<div id="modal" class="fixed inset-0 bg-black/40 hidden items-end">
<div class="bg-white w-full rounded-t-3xl p-5 text-black">

<p id="modalTitle" class="font-bold mb-3"></p>

<input id="valueInput" type="number" placeholder="Valor"
class="w-full border rounded-xl p-3 mb-3">

<div id="categoryButtons" class="grid grid-cols-2 gap-2 mb-4"></div>

<button onclick="confirmAdd()" class="w-full bg-green-600 text-white py-3 rounded-xl active:scale-95">
Confirmar
</button>

<button onclick="closeModal()" class="w-full mt-2 text-gray-500">Cancelar</button>

</div>
</div>

<script>
lucide.createIcons();

let items = [];
let currentType = "";
let selectedCategory = "";
let monthlyLimit = 0;

const incomeCategories = [
  "SalÃ¡rio","Renda Extra","Freelas","ComissÃµes","Investimentos","Outros"
];

const expenseCategories = [
  "Moradia","AlimentaÃ§Ã£o","Transporte","Lazer","Assinaturas",
  "SaÃºde","EducaÃ§Ã£o","Compras","Outros"
];

const messages = {
income:["ðŸ’° Receita registrada!","ðŸ“ˆ Saldo subindo!","ðŸš€ Boa entrada!"],
expense:["ðŸ’¸ Gasto anotado!","âš ï¸ Olho no limite!","ðŸ“‰ Saiu do caixa!"]
};

const chart = new Chart(document.getElementById("chart"),{
type:"pie",
data:{
labels:expenseCategories,
datasets:[{
data:Array(expenseCategories.length).fill(0),
backgroundColor:[
"#16a34a","#22c55e","#4ade80",
"#fde047","#facc15","#86efac",
"#bbf7d0","#65a30d","#4d7c0f"
]}]
}
});

function updateUI(){
const income = items.filter(i=>i.type==="income").reduce((a,b)=>a+b.value,0);
const expense = items.filter(i=>i.type==="expense").reduce((a,b)=>a+b.value,0);

document.getElementById("balance").innerText =
`R$ ${(income-expense).toFixed(2).replace(".",",")}`;

expenseCategories.forEach((cat,i)=>{
chart.data.datasets[0].data[i] =
items.filter(it=>it.type==="expense" && it.category===cat)
.reduce((a,b)=>a+b.value,0);
});
chart.update();

const list = document.getElementById("list");
list.innerHTML="";
items.forEach((it,i)=>{
list.innerHTML+=`
<li class="flex justify-between items-center">
<span>${it.type==="income"?"âž•":"âž–"} ${it.category} - R$ ${it.value}</span>
<button onclick="removeItem(${i})" class="text-red-500">âœ•</button>
</li>`;
});

updateLimit(expense);
}

function saveLimit(){
monthlyLimit = Number(document.getElementById("limitInput").value);
updateLimit(
items.filter(i=>i.type==="expense").reduce((a,b)=>a+b.value,0)
);
}

function updateLimit(totalExpense){
if(!monthlyLimit) return;

let percent = Math.min((totalExpense / monthlyLimit) * 100, 100);
document.getElementById("limitPercent").innerText = percent.toFixed(0) + "%";

const bar = document.getElementById("limitBar");
const status = document.getElementById("limitStatus");

bar.style.width = percent + "%";

if(percent < 60){
bar.className = "h-4 rounded-full bg-green-500 transition-all";
status.innerText = "ðŸŸ¢ Limite sob controle";
}
else if(percent < 90){
bar.className = "h-4 rounded-full bg-yellow-400 transition-all";
status.innerText = "ðŸŸ¡ AtenÃ§Ã£o ao limite";
}
else{
bar.className = "h-4 rounded-full bg-red-500 transition-all";
status.innerText = "ðŸ”´ Limite estourando!";
}
}

function openModal(type){
currentType = type;
selectedCategory = "";
document.getElementById("modalTitle").innerText =
type==="income"?"Adicionar Receita":"Adicionar Gasto";

const container = document.getElementById("categoryButtons");
container.innerHTML="";

(type==="income"?incomeCategories:expenseCategories).forEach(cat=>{
const btn = document.createElement("button");
btn.innerText = cat;
btn.className = "border rounded-xl py-2 active:scale-95 transition";
btn.onclick = ()=>{
selectedCategory = cat;
[...container.children].forEach(b=>b.classList.remove("bg-green-200"));
btn.classList.add("bg-green-200");
};
container.appendChild(btn);
});

document.getElementById("modal").classList.remove("hidden");
}

function closeModal(){
document.getElementById("modal").classList.add("hidden");
}

function confirmAdd(){
const value = Number(document.getElementById("valueInput").value);
if(!value || !selectedCategory) return;

items.push({value,category:selectedCategory,type:currentType});
document.getElementById("valueInput").value="";
closeModal();

document.getElementById("message").innerText =
messages[currentType][Math.floor(Math.random()*messages[currentType].length)];

updateUI();
}

function removeItem(i){
items.splice(i,1);
updateUI();
}
</script>

</body>
</html>
